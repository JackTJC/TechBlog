---
title: 当验证码遇上区块链——用 PoW 对抗机器流量
tags:
  - CAPTCHA
  - 验证码
cover: 'https://img-cdn.tianjincai.top/2025/07/7628cc787e4aafd014c1439a660d005f.png'
abbrlink: 25475
date: 2025-07-20 10:40:05
---

# 背景

博主所在的团队从国内交接了一个验证码系统，支持滑块、3D点选、图像旋转矫正这三个验证能力，由于业务位电商业务，为了用户体验的考量目前只启用了滑块这一种验证类型，目前验证形式上也就是一个随机的凹槽，没有任何干扰，黑产在早期很容易就进行攻破，后续布防了一些加密算法用于防止黑产攻破，但是都是打一个时间窗口差，即黑产攻破->我们升级算法->黑产继续攻破

- 





# 什么是Pow

这里引入一个形象的比喻：



PoW的两个关键特性

- **求解困难 (Difficult to Find):** 找到正确答案需要大量的尝试（算力消耗）。

- **验证容易 (Easy to Verify):** 服务端拿到答案后，可以瞬间验证是否正确。

技术原理

哈希函数

挖矿：

1. 服务端生成挑战字符串（Challenge String），例如`prefix="hello_world"`
2. 服务端设定一个难度目标（Difficulty Target），例如给定4，需要找到`Nonce`,使得`SHA256(prefix+Nonce)`的结果前4位都是0
3. 客户端规则，不断尝试`Nonce=0,1,2,3,4`,直到找到满足条件的`Nonce`

为什么PoW适合验证码场景？

- **对用户友好：** 计算过程在后台由 JS 完成，用户几乎无感知，无需任何输入。
- **对机器不友好：** 攻击者想发起 1000 RPS (请求/秒) 的并发攻击，他的服务器就需要完成 1000 次 PoW 计算，CPU 会被瞬间打满，攻击成本急剧上升。
- **无任何第三方依赖：** 完全自部署，没有隐私泄露风险，不受 Google 等服务在特定区域不可用的影响。
- **动态难度调整：** 可以根据 IP、用户行为等动态调整 PoW 的难度，对可疑用户“加码”。

# 实战：构建一个支持PoW的验证码系统





# 总结

